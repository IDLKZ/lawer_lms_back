
## 1. Миграция базы данных (DB Migration)

Создай **скрипт миграции** (предположительно Alembic, если используется SQLAlchemy) для создания новой таблицы `case_tests`.

**Таблица: `case_tests`**

| Поле | Тип данных | Описание |
| :--- | :--- | :--- |
| **id** | Integer | Первичный ключ (Primary Key) |
| **created_by** | Integer | Внешний ключ (Foreign Key) на `users.id` |
| **case_id** | Integer | Внешний ключ (Foreign Key) на `cases.id` |
| **question** | String | Текст сгенерированного вопроса |
| **answer** | String | Ожидаемый ответ на вопрос |
| **created_at** | DateTime | Время создания (с автоматическим заполнением) |
| **updated_at** | DateTime | Время последнего обновления (с автоматическим заполнением) |

**Примечания:**
1.  Предполагается, что таблицы `users` и `cases` уже существуют.
2.  Таблица `cases` имеет поле `cleaning_text` (String).

---

## 2. Модели (Pydantic и SQLAlchemy)

1.  Создай **SQLAlchemy ORM Model** для таблицы `CaseTest`.
2.  Создай **Pydantic Schemas** (`CaseTestBase`, `CaseTestCreate`, `CaseTestResponse`).

---

## 3. Роут для генерации вопросов

Создай **FastAPI POST роут** по пути `/cases/{case_id}/generate-questions`.

**Endpoint:** `POST /cases/{case_id}/generate-questions`

| Параметр | Расположение | Тип | Описание |
| :--- | :--- | :--- | :--- |
| **case_id** | Path | Integer | ID кейса, для которого генерируются вопросы |
| **count** | Query | Integer | Необязательный. Количество вопросов для генерации. По умолчанию - **5**. |

**Логика роута:**
1.  **Аутентификация/Авторизация:** Роут должен требовать аутентификацию (например, через `Depends(get_current_user)`), чтобы получить `current_user.id` для поля `created_by`.
2.  **Получение данных:** Извлечь из базы данных `case` по `case_id`, включая его поле `cleaning_text`.
3.  **Генерация:** Использовать предоставленную логику генерации (имитация вызова LLM) на основе `case.cleaning_text`.
    * **Имитация LLM:** Для генерации используй функцию, которая принимает `cleaning_text` и `count` и возвращает список объектов `{"question": "...", "answer": "..."}`.
    * **Пример логики/структуры:** Можешь использовать логику, аналогичную роуту `generate_test` из вашего курса (если она включает вызов внешнего сервиса или LLM), но здесь достаточно **имитировать** этот вызов для демонстрации.
4.  **Сохранение:** Сохранить сгенерированные вопросы и ответы в таблице `case_tests`, используя `current_user.id` как `created_by` и полученный `case_id`.
5.  **Ответ:** Вернуть список созданных объектов `CaseTestResponse`.

**Используемые технологии:** FastAPI, SQLAlchemy ORM, Pydantic, и условная имитация LLM-вызова (например, через заглушку).